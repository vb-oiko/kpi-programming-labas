## Завдання 4. Вирішити таку задачу комівояжера методом гілок та меж:

$$
C = \begin{bmatrix}
    \times & 5 & 1 & 10 & 6 & 8 \\
    2 & \times & 3 & 8 & 5 & 10\\
    4 & 8 & \times & 6 & 4 & 9 \\
    6 & 9 & 5 & \times & 3 & 7 \\
    8 & 7 & 7 & 4 & \times & 6 \\
    10 & 4 & 9 & 3 & 2 & \times
\end{bmatrix}
$$

## Розв'язок

Нульовий крок. Застосувавши процедуру зведення, отримаємо матрицю $C_0$

$$
\begin{array}{c|cccccc|}
    i \diagdown i & 0 & 1 & 2 & 3 & 4 & 5 & h_i & \alpha_i \\ \hline
    0 & \times & 5 & 1 & 10 & 6 & 8 & 1 \\
    1 & 2 & \times & 3 & 8 & 5 & 10 & 2\\
    2 & 4 & 8 & \times & 6 & 4 & 9 & 4 \\
    3 & 6 & 9 & 5 & \times & 3 & 7 & 3 \\
    4 & 8 & 7 & 7 & 4 & \times & 6 & 4 \\
    5 & 10 & 4 & 9 & 3 & 2 & \times &2 \\ \hline
H_j & 0    & 2    & 0    & 0    & 0    & 2  \\ \beta_j 
\end{array}
$$

$$ C_0=
\begin{array}{c|cccccc|}
i\diagdown i& 0 & 1 & 2 & 3 & 4 & 5 & h_i & \alpha_i \\ \hline
0   &\times& 2    & \boxed{0^2}    & 9    & 5    & 5    & 1 & 2 \\
1   & 0^1  &\times& 1    & 6    & 3    & 6    & 2 & 1 \\
2   & 0^1    & 2    &\times& 2    & 0^2    & 5    & 4 & 2 \\
3   & 3    & 4    & 2    &\times& 0^2    & 2    & 3 & 2 \\
4   & 4    & 1    & 3    & 0^1    &\times& 0^0    & 4 & 0 \\
5   & 8    & 0^1    & 7    & 1    & 0^0    &\times& 2 & 0\\ \hline
H_j & 0    & 2    & 0    & 0    & 0    & 2  \\ \beta_j 
    & 0    & 1    & 1    & 1    & 0    & 2     
\end{array}
$$

$ \xi(G_0) = \sum h_i + \sum H_j = 20 $


Обираємо пару для розбиття $ (0,2) $

Проводимо розбиття 

$$ G^{(0)} = G_1^{(1)} \cup G_2^{(1)} $$

$$ G_1^{(1)} = G_0 \cap (0,2) $$

$$ G_2^{(1)} = G_0 \cap \overline{(0,2)} $$

Обчислюємо оцінку 

$$ \xi(G_2^{(1)}) = \xi(G_0) + \theta_{0,2}  = 22$$

---------------

Викреслюємо відповідний рядок та стовпчик та здійснюємо перетворення матриці

$$ C_1^{(1)}=
\begin{array}{c|cccccc|}
i\diagdown i& 0 & 1 &   & 3 & 4 & 5 & h_i & \alpha_i \\ \hline
    &      &      &      &      &        &      &   &   \\
1   &\boxed{0^3}&\times&      & 6    & 3      & 6    & 0 & 3 \\
2   &\times& 2    &      & 2    & 0      & 5    & 0 & 0 \\
3   & 3    & 4    &      &\times& 0      & 2    & 0 & 2 \\
4   & 4    & 1    &      & 0      &\times& 0    & 0 & 0 \\
5   & 8    & 0    &      & 1    & 0      &\times& 0 & 0\\ \hline
H_j & 0    & 0    &      & 0    & 0      & 0    \\ \beta_j 
    & 0    & 1    &      & 1    & 0      & 2     
\end{array}
$$

Обчислюємо оцінку 
$ \xi(G_1^{(1)}) = \xi(G_0) + \sum h_i + \sum H_j = 20 $


Обираємо пару для розбиття $ (1,0) $

Проводимо розбиття 

$$ G_1^{(1)} = G_1^{(2)} \cup G_2^{(2)} $$

$$ G_1^{(2)} = G_1^{(1)} \cap (1,0) $$

$$ G_2^{(2)} = G_1^{(1)} \cap \overline{(1,0)} $$

Обчислюємо оцінку 

$$ \xi(G_2^{(2)}) = \xi(G_1^{(1)}) + \theta_{1,0}  = 23$$

---------------

Викреслюємо відповідний рядок та стовпчик та здійснюємо перетворення матриці

$$ C_1^{(2)}=
\begin{array}{c|cccccc|}
i\diagdown i& 0 & 1 &   & 3 & 4 & 5 & h_i & \alpha_i \\ \hline
    &      &      &      &      &        &      &   &   \\
1   &      &      &      &      &        &      &   &   \\
2   &      &\times&      & 2    & 0      & 5    & 0 & 2 \\
3   &      & 4    &      &\times& 0      & 2    & 0 & 2 \\
4   &      & 1    &      & 0      &\times&\boxed{0^2}& 0 & 0 \\
5   &      & 0    &      & 1    & 0      &\times& 0 & 0\\ \hline
H_j &      & 0    &      & 0    & 0      & 0    \\ \beta_j 
    &      & 1    &      & 1    & 0      & 2     
\end{array}
$$

Обчислюємо оцінку 
$ \xi(G_1^{(2)}) = \xi(G_1^{(1)}) + \sum h_i + \sum H_j = 20 $


Обираємо пару для розбиття $ (4,5) $

Проводимо розбиття 

$$ G_1^{(2)} = G_1^{(3)} \cup G_2^{(3)} $$

$$ G_1^{(3)} = G_1^{(2)} \cap (4,5) $$

$$ G_2^{(3)} = G_1^{(2)} \cap \overline{(4,5)} $$

Обчислюємо оцінку 

$$ \xi(G_2^{(3)}) = \xi(G_1^{(2)}) + \theta_{4,5}  = 23$$

---------------

Викреслюємо відповідний рядок та стовпчик та здійснюємо перетворення матриці

$$ C_1^{(3)}=
\begin{array}{c|cccccc|}
i\diagdown i& 0 & 1 &   & 3 & 4 & 5 & h_i & \alpha_i \\ \hline
    &      &      &      &      &        &      &   &   \\
1   &      &      &      &      &        &      &   &   \\
2   &      &\times&      & 1    & 0      &      & 0 & 1 \\
3   &      & 4    &      &\times&\boxed{0^4}&      & 0 & 4 \\
4   &      &      &      &        &      &      &   &   \\
5   &      & 0    &      & 0    & 0      &      & 0 & 0\\ \hline
H_j &      & 0    &      & 1    & 0      &      \\ \beta_j 
    &      & 4    &      & 1    & 0      &       
\end{array}
$$



Обчислюємо оцінку 
$ \xi(G_1^{(3)}) = \xi(G_1^{(2)}) + \sum h_i + \sum H_j = 21 $

Обираємо пару для розбиття $ (3,4) $

Проводимо розбиття 

$$ G_1^{(3)} = G_1^{(4)} \cup G_2^{(4)} $$

$$ G_1^{(4)} = G_1^{(3)} \cap (3,4) $$

$$ G_2^{(4)} = G_1^{(3)} \cap \overline{(3,4)} $$

Обчислюємо оцінку 

$$ \xi(G_2^{(4)}) = \xi(G_1^{(3)}) + \theta_{3,4}  = 24$$

---------------

Викреслюємо відповідний рядок та стовпчик та здійснюємо перетворення матриці

$$ C_1^{(4)}=
\begin{array}{c|cccccc|}
i\diagdown i& 0 & 1 &   & 3 & 4 & 5 & h_i & \alpha_i \\ \hline
    &      &      &      &      &        &      &   &   \\
1   &      &      &      &      &        &      &   &   \\
2   &      &\times&      & 1    &        &      & 1 &   \\
3   &      &      &      &      &        &      &   &   \\
4   &      &      &      &      &        &      &   &   \\
5   &      & 0    &      &\times&        &      & 0  &  \\ \hline
H_j &      & 0    &      & 1    &        &      \\ \beta_j 
    &      &      &      &      &        &       
\end{array}
$$


Обчислюємо оцінку 
$ \xi(G_1^{(4)}) = \xi(G_1^{(3)}) + \sum h_i + \sum H_j = 22 $

Із матриці $ C_1^{(4)} $ вибираємо дві останні пари: $(2,3)$ та $(5,1)$. В результаті отримуємо цикл, що відповідає множині

$$ G_1^{(6)} = \{ (0,2), (2,3), (3,4), (4,5), (5,1), (1,0) \} $$

Довжина цього циклу дорівнює оцінці для множини $ G_1^{(6)}: l = \xi( G_1^{(6)}) = 22$