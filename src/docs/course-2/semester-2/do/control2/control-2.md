## Модульна контрольна робота №2

### Група ІС-02. Бойко Василь Олександрович

### Варіант 1.

#### 1. Опишіть метод розв'язування динамічної задачі управління запасами 

Задача управління запасами полягає у плануванні роботи системи постачання на $n$ періодів. 
$x_j$ – запас, який створюється в $j$-період або замовлення $j$-го періоду. 
$y_j$ – залишок від запасу $j$-1 періоду. 
$d_j$ – попит у $j$-ому періоді. 
$C_j(x_j)$ – витрати на виконання замовлення, 
$S_j(x_j + y_j - d_j)$ – витрати на зберігання. 
Необхідно визначити запас/замовлення кожного періоду, при якому мінімізуються сумарні витрати.

На кожному кроці $k$ розглядаємо варіанти замовлення поточного попиту у кожному періоді (з першого по поточний) та  розраховуємо сумарні витрати у такому варіанту - $g_k(i)$. 

Для кожного з цих варіантів ці витрати складатимуться з сумарних витрат, які вже розраховано для періоду, що передує замовленню поточного попиту - $\Lambda_{i-1}(0)$, 

вартості замовлення партії, яка включає поточний попит - 

$C_i(x_i) = C(\sum_{l=i}^{k}d_l)$, 

та витрат на зберігання:

$\sum_{j=i}^{k-1} S_j \sum_{u=j}^{k} d_u$ 

Далі обирається найкращій варіант з найменшою сумарною сумою витрат, який буде використовуватися у наступних кроках.

Отже, основне рекурентне співвідношення:

$\Lambda_{k}(0) = \underset{1 \le i \le k}{min} (g_k(i)) $

$g_k(i) = \Lambda_{i-1}(0) + C(\sum_{l=i}^{k}d_l) + \sum_{j=i}^{k-1} S_j \sum_{u=j}^{k} d_u$

На першому кроці сума витрат буде дорівнювати сумі замовлення попиту за перший період:

$\Lambda_{0}(0) = C(d_1)$



#### 2. Розв'язати задачу квадратичного програмування

$ max \, f(x_1, x_2) = max(32x_1 + 120x_2 − 4x_1^2 − 15x_2^2) $

$2x_1 +5x_2 \le 20$

$2x_1 −x_2 =8$

$x1,x2 \ge 0$

##### Розв'язок

$ max \, f(x_1, x_2) = max(32 x_1 + 120 x_2 − 4 x_1^2 − 15 x_2^2) $

$20 - 2x_1  -5x_2 \ge 0$

$8 - 2x_1 + x_2 = 0$

$x1,x2 \ge 0$

Визначаємо характер функції

$ \Delta_1 = -8 < 0$

$ \Delta_2 = 
\begin{vmatrix}
    -8 &  0 \\
    0 &  -30 \\
\end{vmatrix} = 240 > 0
$

Функція $f(x_1, x_2)$ є вгнутою, отже ця задача є задачею квадратичного програмування.

Побудуємо функцію Лагранжа

$ L(x_1, x_2, \lambda_1, \lambda_2) = (32x_1 + 120x_2 − 4x_1^2 − 15x_2^2) +  \lambda_1 (20 - 2x_1  -5x_2) + \lambda_2 (8 - 2x_1 + x_2) $

Застосувавши теорему Куна-Такера, одержимо такі умови для оптимального розв'язку

$\frac{\partial L}{\partial x_1} = 32 - 8x_1 - 2 \lambda_1 - 2 \lambda_2 \le 0 $

$\frac{\partial L}{\partial x_2} = 120 - 30x_2 -5 \lambda_1 + \lambda_2 \le 0 $

$\frac{\partial L}{\partial \lambda_1} = 20 - 2x_1  -5x_2 \ge 0 $

$\frac{\partial L}{\partial \lambda_2} = 8 - 2x_1 + x_2 = 0 $

Умови доповняльної нежорсткості

$\frac{\partial L}{\partial x_1} x_1 = 0 $

$\frac{\partial L}{\partial x_2} x_2 = 0 $

$\frac{\partial L}{\partial \lambda_1} \lambda_1 = 0 $

Увівши у систему з обмеженнями вільні змінні $v_1, v_2, w_1$ дістанемо таку систему:


$32 - 8x_1 - 2 \lambda_1 - 2 \lambda_2 + v_1 = 0 $

$120 - 30x_2 -5 \lambda_1 + \lambda_2 + v_2 = 0 $

$20 - 2x_1  -5x_2 - w_1 = 0 $

$8 - 2x_1 + x_2 = 0 $

Друге обмеження в умові задачі виконується як строга рівність, тому немає обмеження на знак змінної $\lambda_2$. Проте оскільки симплекс-метод дає змогу знаходити лише невід’ємні базисні розв'язки, то зробимо заміну змінних:

$ \lambda_2 = \lambda_3 - \lambda_4,\quad \lambda_3 \ge 0, \quad \lambda_4 \ge 0 $

Запишемо систему в еквівалентному вигляді:

$32 - 8x_1 - 2 \lambda_1 - 2 \lambda_3 + 2 \lambda_4 + v_1 = 0 $

$120 - 30x_2 -5 \lambda_1 + \lambda_3 - \lambda_4 + v_2 = 0 $

$20 - 2x_1  -5x_2 - w_1 = 0 $

$8 - 2x_1 + x_2 = 0 $

Перенесемо вільні члени до правої частини рівнянь:

$ 8x_1 + 2 \lambda_1 + 2 \lambda_3 - 2 \lambda_4 - v_1 = 32 $

$ 30x_2 + 5 \lambda_1 - \lambda_3 + \lambda_4 - v_2 = 120 $

$2x_1 + 5x_2 + w_1 = 20 $

$ 2x_1 - x_2 = 8 $

Треба знайти ДБР цієї системи з урахуванням обмежень доповняльної нежорсткості. Для цього застосуємо метод штучних змінних. Введемо штучні змінні $y_1$, $y_2$, $y_3$ в перше, друге та четверте обмеження.

В результаті отримуємо таку задачу ЛП:

$ min \, M (y_1 + y_2 + y_3) $

$ 8x_1 + 2 \lambda_1 + 2 \lambda_3 - 2 \lambda_4 - v_1 + y_1 = 32 $

$ 30x_2 + 5 \lambda_1 - \lambda_3 + \lambda_4 - v_2 + y_2 = 120 $

$2x_1 + 5x_2 + w_1 = 20 $

$ 2x_1 - x_2 + y_3 = 8 $

Розв'язуємо задачу симплекс методом.

|     |       |       | 0     | 0           | 0           | 0           | 0           | 0     | 0     | 0     | M     | M     | M     |
| --- | ----- | ----- | ----- | ----------- | ----------- | ----------- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- |
|     | $B_x$ | $A_0$ | $x_1$ | $x_2$       | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$ | $v_2$ | $w_1$ | $y_1$ | $y_2$ | $y_3$ |
| 0   | $w_1$ | 20    | 2     | $\boxed{5}$ | 0           | 0           | 0           | 0     | 0     | 1     | 0     | 0     | 0     |
| M   | $y_1$ | 32    | 8     | 0           | 2           | 2           | -2          | -1    | 0     | 0     | 1     | 0     | 0     |
| M   | $y_2$ | 120   | 0     | 30          | 5           | -1          | 1           | 0     | -1    | 0     | 0     | 1     | 0     |
| M   | $y_3$ | 8     | 2     | -1          | 0           | 0           | 0           | 0     | 0     | 0     | 0     | 0     | 1     |
|     |       | 160M  | 10M   | 29M         | 7M          | M           | -M          | -M    | -M    | 0     | 0     | 0     | 0     |


|     |       |       | 0             | 0     | 0           | 0           | 0           | 0     | 0     | 0     | M     | M     | M     |
| --- | ----- | ----- | ------------- | ----- | ----------- | ----------- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- |
|     | $B_x$ | $A_0$ | $x_1$         | $x_2$ | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$ | $v_2$ | $w_1$ | $y_1$ | $y_2$ | $y_3$ |
| 0   | $x_2$ | 4     | 0.4           | 1     | 0           | 0           | 0           | 0     | 0     | 0.2   | 0     | 0     | 0     |
| M   | $y_1$ | 32    | 8             | 0     | 2           | 2           | -2          | -1    | 0     | 0     | 1     | 0     | 0     |
| M   | $y_2$ | 0     | -12           | 0     | 5           | -1          | 1           | 0     | -1    | -6    | 0     | 1     | 0     |
| M   | $y_3$ | 12    | $\boxed{2.4}$ | 0     | 0           | 0           | 0           | 0     | 0     | 0.2   | 0     | 0     | 1     |
|     |       | 44M   | -1,6M         | 0     | 7M          | M           | -M          | -M    | -M    | -5,8M | 0     | 0     | 0     |


|     |       |       | 0     | 0     | 0           | 0           | 0           | 0     | 0     | 0       | M     | M     |
| --- | ----- | ----- | ----- | ----- | ----------- | ----------- | ----------- | ----- | ----- | ------- | ----- | ----- |
|     | $B_x$ | $A_0$ | $x_1$ | $x_2$ | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$ | $v_2$ | $w_1$   | $y_1$ | $y_2$ |
| 0   | $x_2$ | 2     | 0     | 1     | 0           | 0           | 0           | 0     | 0     | 0.16667 | 0     | 0     |
| M   | $y_1$ | 8     | 0     | 0     | -2          | -2          | 2           | 1     | 0     | 0.66667 | -1    | 0     |
| M   | $y_2$ | 60    | 0     | 0     | $\boxed{5}$ | -1          | 1           | 0     | -1    | -5      | 0     | 1     |
| 0   | $x_1$ | 5     | 1     | 0     | 0           | 0           | 0           | 0     | 0     | 0.08333 | 0     | 0     |
|     |       | 68M   | 0     | 0     | 3M          | -3M         | 3M          | M     | -M    | -4,333M | -2M   | 0     |


|     |             |       | 0     | 0     | 0           | 0           | 0             | 0     | 0     | 0        | M     |
| --- | ----------- | ----- | ----- | ----- | ----------- | ----------- | ------------- | ----- | ----- | -------- | ----- |
|     | $B_x$       | $A_0$ | $x_1$ | $x_2$ | $\lambda_1$ | $\lambda_3$ | $\lambda_4$   | $v_1$ | $v_2$ | $w_1$    | $y_1$ |
| 0   | $x_2$       | 2     | 0     | 1     | 0           | 0           | 0             | 0     | 0     | 0.16667  | 0     |
| M   | $y_1$       | 32    | 0     | 0     | 0           | -2.4        | $\boxed{2.4}$ | 1     | -0.4  | -1.33333 | -1    |
| 0   | $\lambda_1$ | 12    | 0     | 0     | 1           | -0.2        | 0.2           | 0     | -0.2  | -1       | 0     |
| 0   | $x_1$       | 5     | 1     | 0     | 0           | 0           | 0             | 0     | 0     | 0.08333  | 0     |
|     |             | 32M   | 0     | 0     | 0           | -2,4M       | 2,4M          | M     | -0.4M | -1,333M  | -2M   |


|     |             |         | 0     | 0     | 0           | 0           | 0           | 0        | 0        | 0        |
| --- | ----------- | ------- | ----- | ----- | ----------- | ----------- | ----------- | -------- | -------- | -------- |
|     | $B_x$       | $A_0$   | $x_1$ | $x_2$ | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$    | $v_2$    | $w_1$    |
| 0   | $x_2$       | 2       | 0     | 1     | 0           | 0           | 0           | 0        | 0        | 0.16667  |
| 0   | $\lambda_4$ | 13.3333 | 0     | 0     | 0           | -1          | 1           | 0.41667  | -0.16667 | -0.55556 |
| 0   | $\lambda_1$ | 9.3333  | 0     | 0     | 1           | 0           | 0           | -0.08333 | -0.16667 | -0.88889 |
| 0   | $x_1$       | 5       | 1     | 0     | 0           | 0           | 0           | 0        | 0        | 0.08333  |
|     |             | 0       | 0     | 0     | 0           | 0           | 0           | 0        | 0        | 0        |

Отримує наступний розв'язок:

$ x_1 = 5, x_2 = 2, \lambda_1 = 9\frac{1}{3}, \lambda_2 = 13\frac{1}{3} $

Перевіряємо, чи виконуються умови доповняльної нежорсткості. Умови виконуються, отже цей розв'язок є оптимальним.



#### 3. Знайти розв'язок динамічної задачі управління запасами

Знайти розв'язок динамічної задачі управління запасами при вихідних даних, наведених нижче. З'ясуйте при яких співвідношеннях між $A$ та $S$ оптимальна програма випуску буде співпадати з попитом по періодах. 

$N = 8$ 

Попит по періодам дорівнює: $d_1 =10, d_2 =15, d_3 =20, d_4 =30, d_5 =25, d_6 =18,d_7 =20$

$S=1$

$ C(x_n) = \begin{cases}
   100 + 6x_n &\text{якщо } x_n > 0 \\
   0 &\text{в іншому випадку }
\end{cases}  $

$ y_1 = y_8 = 0$

$\Lambda_1(0) = C(d_1) = 100 + 6 * 10 = 160$

$\Lambda_2(0) =min \begin{cases}
   g_1(1) = C(d_1 + d_2) + 1* S(d_2) = 100 + 6 * (10+15) + 1*15 = 265 \\
   g_1(2) = \Lambda_1(0) + C(d_2) = 160 + 100 + 6*15 = 350
\end{cases}
$

$\Lambda_2(0) = 265$

$\Lambda_3(0) =min \begin{cases} 
   g_3(1) = C(d_1 + d_2+d_3) + 1*S(d_2) + 2*S(d_3)  \\
   g_2(2) = \Lambda_1(0) + C(d_2+d_3) + 1*S(d_3) \\
   g_2(3) = \Lambda_2(0) + C(d_3)
\end{cases}
$

$\Lambda_3(0) =min \begin{cases} 
   g_2(1) = 100 + 6 * (10+15+20) + 1*15 +2*20 = 425 \\
   g_2(2) =  160 + 100 + 6*(15+20) +1*20= 490 \\
   g_2(3) =  265 + 100 + 6*20 = 485
\end{cases}
$

$\Lambda_3(0) = 425$


$\Lambda_4(0) =min \begin{cases} 
   g_4(1) = C(d_1+d_2+d_3+d_4) + 1*S(d_2) + 2*S(d_3)+ 3*S(d_4)  \\
   g_4(2) = \Lambda_1(0) + C(d_2+d_3+d_4) + 1*S(d_3)+ 2*S(d_4) \\
   g_4(3) = \Lambda_2(0) + C(d_3+d_4) + 1*S(d_4) \\
   g_4(4) = \Lambda_3(0) + C(d_4)
\end{cases}
$

$\Lambda_4(0) =min \begin{cases} 
   g_4(1) = 100+6*(10+15+20+30) + 1*15 + 2*20+ 3*30 = 695 \\
   g_4(2) = 160 + 100+6*(15+20+30) + 1*20+ 2*30 = 730  \\
   g_4(3) = 265 + 100+6*(20+30) + 1*30 =695 \\
   g_4(4) = 705
\end{cases}
$

$\Lambda_4(0) = 695$

$\Lambda_5(0) =min \begin{cases} 
   g_5(1)=C(d_1+d_2+d_3+d_4+d_5)+1*S(d_2)+2*S(d_3)+3*S(d_4)+4*S(d_5)\\
   g_5(2)=\Lambda_1(0)+C(d_2+d_3+d_4+d_5)+1*S(d_3)+2*S(d_4)+3*S(d_5)\\
   g_5(3)=\Lambda_2(0)+C(d_3+d_4+d_5)+1*S(d_4)+2*S(d_5)\\
   g_5(4)=\Lambda_3(0)+C(d_4+d_5)+1*S(d_5)\\
   g_5(5)=\Lambda_4(0)+C(d_5)
\end{cases}
$


$\Lambda_5(0) =min \begin{cases} 
   g_5(1)=100+6*(10+15+20+30+25)+1*15+2*20+3*30+4*25=945\\
   g_5(2)=160+100+6*(15+20+30+25)+1*20+2*30+3*25=955\\
   g_5(3)=265+100+6*(20+30+25)+1*30+2*25=895\\
   g_5(4)=425+100+6*(30+25)+1*25=880\\
   g_5(5)=695+100+6*25=945 
\end{cases}
$

$\Lambda_5(0) = 880$

$\Lambda_6(0) =min \begin{cases} 
   g_6(1)=C(d_1+d_2+d_3+d_4+d_5+d_6)+1*S(d_2)+2*S(d_3)+3*S(d_4)+4*S(d_5)+5*S(d_6)\\
   g_6(2)=\Lambda_1(0)+C(d_2+d_3+d_4+d_5+d_6)+1*S(d_3)+2*S(d_4)+3*S(d_5)+4*S(d_6)\\
   g_6(3)=\Lambda_2(0)+C(d_3+d_4+d_5+d_6)+1*S(d_4)+2*S(d_5)+3*S(d_6)\\
   g_6(4)=\Lambda_3(0)+C(d_4+d_5+d_6)+1*S(d_5)+2*S(d_6)\\
   g_6(5)=\Lambda_4(0)+C(d_5+d_6)+1*S(d_6)\\
   g_6(6)=\Lambda_5(0)+C(d_6)
\end{cases}
$


$\Lambda_6(0) =min \begin{cases} 
   g_6(1)=100+6*(10+15+20+30+25+18)+1*15+2*20+3*30+4*25+5*18=1143\\
   g_6(2)=160+100+6*(15+20+30+25+18)+1*20+2*30+3*25+4*18=1135\\
   g_6(3)=265+100+6*(20+30+25+18)+1*30+2*25+3*18=1057\\
   g_6(4)=425+100+6*(30+25+18)+1*25+2*18=1024\\
   g_6(5)=695+100+6*(25+18)+1*18=1071\\
   g_6(6)=880+100+6*18=1088
\end{cases}
$

$\Lambda_6(0) = 1024$

$\Lambda_7(0) =min \begin{cases} 
   g_7(1)=C(d_1+d_2+d_3+d_4+d_5+d_6+d_7)+1*S(d_2)+2*S(d_3)+3*S(d_4)+4*S(d_5)+5*S(d_6)+6*S(d_7)\\
   g_7(2)=\Lambda_1(0)+C(d_2+d_3+d_4+d_5+d_6+d_7)+1*S(d_3)+2*S(d_4)+3*S(d_5)+4*S(d_6)+5*S(d_7)\\
   g_7(3)=\Lambda_2(0)+C(d_3+d_4+d_5+d_6+d_7)+1*S(d_4)+2*S(d_5)+3*S(d_6)+4*S(d_7)\\
   g_7(4)=\Lambda_3(0)+C(d_4+d_5+d_6+d_7)+1*S(d_5)+2*S(d_6)+3*S(d_7)\\
   g_7(5)=\Lambda_4(0)+C(d_5+d_6+d_7)+1*S(d_6)+2*S(d_7)\\
   g_7(6)=\Lambda_5(0)+C(d_6+d_7)+1*S(d_7)\\
   g_7(7)=\Lambda_6(0)+C(d_7)
\end{cases}
$


$\Lambda_7(0) =min \begin{cases} 
   g_7(1)=100+6*(10+15+20+30+25+18+20)+1*15+2*20+3*30+4*25+5*18+6*20=1383\\
   g_7(2)=160+100+6*(15+20+30+25+18+20)+1*20+2*30+3*25+4*18+5*20=1355\\
   g_7(3)=265+100+6*(20+30+25+18+20)+1*30+2*25+3*18+4*20=1257\\
   g_7(4)=425+100+6*(30+25+18+20)+1*25+2*18+3*20=1204\\
   g_7(5)=695+100+6*(25+18+20)+1*18+2*20=1231\\
   g_7(6)=880+100+6*(18+20)+1*20=1228\\
   g_7(7)=1024+100+6*20=1244
\end{cases}
$

$\Lambda_7(0) = 1204$

Замовлення зроблено у 1й та 4й період.

$x_1 = d_1 + d_2 + d_3 = 10+15+20 = 45$
$x_2=0$
$x_3=0$
$x_4 = d_4 + d_5 + d_6 + d_7 = 30+25+18+20 = 93$
$x_5=0$
$x_6=0$
$x_7=0$

Значення цільової функції = 1204