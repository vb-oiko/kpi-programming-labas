## Модульна контрольна робота №2

### Група ІС-02. Бойко Василь Олександрович

### Варіант 1.

#### 2. Розв'язати задачу квадратичного програмування

$ max \, f(x_1, x_2) = max(32x_1 + 120x_2 − 4x_1^2 − 15x_2^2) $

$2x_1 +5x_2 \le 20$

$2x_1 −x_2 =8$

$x1,x2 \ge 0$

##### Розв'язок

$ max \, f(x_1, x_2) = max(32 x_1 + 120 x_2 − 4 x_1^2 − 15 x_2^2) $

$20 - 2x_1  -5x_2 \ge 0$

$8 - 2x_1 + x_2 = 0$

$x1,x2 \ge 0$

Визначаємо характер функції

$ \Delta_1 = -8 < 0$

$ \Delta_2 = 
\begin{vmatrix}
    -8 &  0 \\
    0 &  -30 \\
\end{vmatrix} = 240 > 0
$

Функція $f(x_1, x_2)$ є вгнутою, отже ця задача є задачею квадратичного програмування.

Побудуємо функцію Лагранжа

$ L(x_1, x_2, \lambda_1, \lambda_2) = (32x_1 + 120x_2 − 4x_1^2 − 15x_2^2) +  \lambda_1 (20 - 2x_1  -5x_2) + \lambda_2 (8 - 2x_1 + x_2) $

Застосувавши теорему Куна-Такера, одержимо такі умови для оптимального розв'язку

$\frac{\partial L}{\partial x_1} = 32 - 8x_1 - 2 \lambda_1 - 2 \lambda_2 \le 0 $

$\frac{\partial L}{\partial x_2} = 120 - 30x_2 -5 \lambda_1 + \lambda_2 \le 0 $

$\frac{\partial L}{\partial \lambda_1} = 20 - 2x_1  -5x_2 \ge 0 $

$\frac{\partial L}{\partial \lambda_2} = 8 - 2x_1 + x_2 = 0 $

Умови доповняльної нежорсткості

$\frac{\partial L}{\partial x_1} x_1 = 0 $

$\frac{\partial L}{\partial x_2} x_2 = 0 $

$\frac{\partial L}{\partial \lambda_1} \lambda_1 = 0 $

Увівши у систему з обмеженнями вільні змінні $v_1, v_2, w_1$ дістанемо таку систему:


$32 - 8x_1 - 2 \lambda_1 - 2 \lambda_2 + v_1 = 0 $

$120 - 30x_2 -5 \lambda_1 + \lambda_2 + v_2 = 0 $

$20 - 2x_1  -5x_2 - w_1 = 0 $

$8 - 2x_1 + x_2 = 0 $

Друге обмеження в умові задачі виконується як строга рівність, тому немає обмеження на знак змінної $\lambda_2$. Проте оскільки симплекс-метод дає змогу знаходити лише невід’ємні базисні розв'язки, то зробимо заміну змінних:

$ \lambda_2 = \lambda_3 - \lambda_4,\quad \lambda_3 \ge 0, \quad \lambda_4 \ge 0 $

Запишемо систему в еквівалентному вигляді:

$32 - 8x_1 - 2 \lambda_1 - 2 \lambda_3 + 2 \lambda_4 + v_1 = 0 $

$120 - 30x_2 -5 \lambda_1 + \lambda_3 - \lambda_4 + v_2 = 0 $

$20 - 2x_1  -5x_2 - w_1 = 0 $

$8 - 2x_1 + x_2 = 0 $

Перенесемо вільні члени до правої частини рівнянь:

$ 8x_1 + 2 \lambda_1 + 2 \lambda_3 - 2 \lambda_4 - v_1 = 32 $

$ 30x_2 + 5 \lambda_1 - \lambda_3 + \lambda_4 - v_2 = 120 $

$2x_1 + 5x_2 + w_1 = 20 $

$ 2x_1 - x_2 = 8 $

Треба знайти ДБР цієї системи з урахуванням обмежень доповняльної нежорсткості. Для цього застосуємо метод штучних змінних. Введемо штучні змінні $y_1$, $y_2$, $y_3$ в перше, друге та четверте обмеження.

В результаті отримуємо таку задачу ЛП:

$ min \, M (y_1 + y_2 + y_3) $

$ 8x_1 + 2 \lambda_1 + 2 \lambda_3 - 2 \lambda_4 - v_1 + y_1 = 32 $

$ 30x_2 + 5 \lambda_1 - \lambda_3 + \lambda_4 - v_2 + y_2 = 120 $

$2x_1 + 5x_2 + w_1 = 20 $

$ 2x_1 - x_2 + y_3 = 8 $

Розв'язуємо задачу симплекс методом.

|     |       |       | 0     | 0            | 0           | 0           | 0           | 0     | 0     | 0     | M     | M     | M     |
| --- | ----- | ----- | ----- | ------------ | ----------- | ----------- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- |
|     | $B_x$ | $A_0$ | $x_1$ | $x_2$        | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$ | $v_2$ | $w_1$ | $y_1$ | $y_2$ | $y_3$ |
| 0   | $w_1$ | 20    | 2     | 5            | 0           | 0           | 0           | 0     | 0     | 1     | 0     | 0     | 0     |
| M   | $y_1$ | 32    | 8     | 0            | 2           | 2           | -2          | -1    | 0     | 0     | 1     | 0     | 0     |
| M   | $y_2$ | 120   | 0     | $\boxed{30}$ | 5           | -1          | 1           | 0     | -1    | 0     | 0     | 1     | 0     |
| M   | $y_3$ | 8     | 2     | -1           | 0           | 0           | 0           | 0     | 0     | 0     | 0     | 0     | 1     |
|     |       | 160M  | 10M   | 29M          | 7M          | M           | -M          | -M    | -M    | 0     | 0     | 0     | 0     |


|     |       |       | 0     | 0     | 0           | 0           | 0           | 0     | 0     | 0     | M     | M     | M     |
| --- | ----- | ----- | ----- | ----- | ----------- | ----------- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- |
|     | $B_x$ | $A_0$ | $x_1$ | $x_2$ | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$ | $v_2$ | $w_1$ | $y_1$ | $y_2$ | $y_3$ |
| 0   | $x_2$ | 4     | 0.4   | 1     | 0           | 0           | 0           | 0     | 0     | 0.2   | 0     | 0     | 0     |
| M   | $y_1$ | 32    | 8     | 0     | 2           | 2           | -2          | -1    | 0     | 0     | 1     | 0     | 0     |
| M   | $y_2$ | 0     | -12   | 0     | 5           | -1          | 1           | 0     | -1    | -6    | 0     | 1     | 0     |
| M   | $y_3$ | 12    | 2.4   | 0     | 0           | 0           | 0           | 0     | 0     | 0.2   | 0     | 0     | 1     |
|     |       | 44M   | -1,6M | 0     | 7M          | M           | -M          | -M    | -M    | -5,8M | 0     | 0     | 0     |


|     |       |       | 0     | 0     | 0           | 0           | 0           | 0     | 0     | 0       | M     | M     | M        |
| --- | ----- | ----- | ----- | ----- | ----------- | ----------- | ----------- | ----- | ----- | ------- | ----- | ----- | -------- |
|     | $B_x$ | $A_0$ | $x_1$ | $x_2$ | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$ | $v_2$ | $w_1$   | $y_1$ | $y_2$ | $y_3$    |
| 0   | $x_2$ | 2     | 0     | 1     | 0           | 0           | 0           | 0     | 0     | 0.16667 | 0     | 0     | -0.16667 |
| M   | $y_1$ | 8     | 0     | 0     | -2          | -2          | 2           | 1     | 0     | 0.66667 | -1    | 0     | 3.33333  |
| M   | $y_2$ | 60    | 0     | 0     | 5           | -1          | 1           | 0     | -1    | -5      | 0     | 1     | 5        |
| 0   | $x_1$ | 5     | 1     | 0     | 0           | 0           | 0           | 0     | 0     | 0.08333 | 0     | 0     | 0.41667  |
|     |       | 68M   | 0     | 0     | 3M          | -3M         | 3M          | M     | -M    | -4,333M | -2M   | 0     | 7,333    |


|     |             |       | 0     | 0     | 0           | 0           | 0           | 0     | 0     | 0        | M     | M     | M        |
| --- | ----------- | ----- | ----- | ----- | ----------- | ----------- | ----------- | ----- | ----- | -------- | ----- | ----- | -------- |
|     | $B_x$       | $A_0$ | $x_1$ | $x_2$ | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$ | $v_2$ | $w_1$    | $y_1$ | $y_2$ | $y_3$    |
| 0   | $x_2$       | 2     | 0     | 1     | 0           | 0           | 0           | 0     | 0     | 0.16667  | 0     | 0     | -0.16667 |
| M   | $y_1$       | 32    | 0     | 0     | 0           | -2.4        | 2.4         | 1     | -0.4  | -1.33333 | -1    | 0.4   | 5.33333  |
| 0   | $\lambda_1$ | 12    | 0     | 0     | 1           | -0.2        | 0.2         | 0     | -0.2  | -1       | 0     | 0.2   | 1        |
| 0   | $x_1$       | 5     | 1     | 0     | 0           | 0           | 0           | 0     | 0     | 0.08333  | 0     | 0     | 0.41667  |
|     |             | 32M   | 0     | 0     | 0           | -2,4M       | 2,4M        | M     | -0.4M | -1,333M  | -2M   | -0.6M | 4,333M   |


|     |             |         | 0     | 0     | 0           | 0           | 0           | 0        | 0        | 0        | M        | M       | M        |
| --- | ----------- | ------- | ----- | ----- | ----------- | ----------- | ----------- | -------- | -------- | -------- | -------- | ------- | -------- |
|     | $B_x$       | $A_0$   | $x_1$ | $x_2$ | $\lambda_1$ | $\lambda_3$ | $\lambda_4$ | $v_1$    | $v_2$    | $w_1$    | $y_1$    | $y_2$   | $y_3$    |
| 0   | $x_2$       | 2       | 0     | 1     | 0           | 0           | 0           | 0        | 0        | 0.16667  | 0        | 0       | -0.16667 |
| 0   | $\lambda_4$ | 13.3333 | 0     | 0     | 0           | -1          | 1           | 0.41667  | -0.16667 | -0.55556 | -0.41667 | 0.16667 | 2.22222  |
| 0   | $\lambda_1$ | 9.3333  | 0     | 0     | 1           | 0           | 0           | -0.08333 | -0.16667 | -0.88889 | 0.08333  | 0.16667 | 0.55556  |
| 0   | $x_1$       | 5       | 1     | 0     | 0           | 0           | 0           | 0        | 0        | 0.08333  | 0        | 0       | 0.41667  |
|     |             | 0       | 0     | 0     | 0           | 0           | 0           | 0        | 0        | 0        | -M       | -M      | -M       |

Отримує наступний розв'язок:

$ x_1 = 5, x_2 = 2, \lambda_1 = 9\frac{1}{3}, \lambda_2 = 13\frac{1}{3} $

Перевіряємо, чи виконуються умови доповняльної нежорсткості. Умови виконуються, отже цей розв'язок є оптимальним.