# Транспортна задача

Для нижченаведених варіантів задач розв'язати транспортну задачу. В таблицях такі позначення: $a_i$ – запаси однорідного продукту у $i$-го постачальника , $b_j$ – потреба в продукті $j$-го споживача. У комірках таблиць наведені вартості $C_{ij}$ перевезення одиниці вантажу від $i$-го постачальника $j$-му споживачу.

## Варіант 2.

| $a_i \backslash b_j$ | 150 | 140 | 110 | 120 |
|:--------------------:|:---:|:---:|:---:|:----:|
| 200 | 8 | 9 | 10 | 9 |
| 180 | 5 | 3 | 4 | 3 |
| 130 | 4 | 5 | 6 | 4 |
| 170 | 3 | 4 | 6 | 3 |

## Розв'язок

Перевіримо необхідність та достатність умов розв'язання задачі.

$$\sum a_i = 200 + 180 + 130 + 170 = 680$$

$$\sum b_j = 150 + 140 + 110 + 120 = 520$$

Як можна побачити, сумарна потреба в продукті у споживачів менше запасів продукту у постачальників. Отже, модель вихідної транспортної задачі є відкритою. Щоб отримати закриту модель, введемо додаткову (фіктивну) потребу, яка дорівнює $680-520=160$. Вартість перевезення одиниці продукту до цього споживача вважаємо рівною нулю.

Занесемо вихідні дані в розподільну таблицю.

| $a_i \backslash b_j$ | 150 | 140 | 110 | 120 | 160 |
|:--------------------:|:---:|:---:|:---:|:----:|:----:|
| 200 | 8 | 9 | 10 | 9 |0
| 180 | 5 | 3 | 4 | 3 |0
| 130 | 4 | 5 | 6 | 4 |0
| 170 | 3 | 4 | 6 | 3 | 0

Заповнюємо матрицю методом мінімального елементу

Мінімальний елемент  $c_{22} = 3$. Для цього елемента запаси рівні 180, потреби 140. Оскільки мінімальним є 140, то віднімаємо його.

| $a_i \backslash b_j$ | 150 |   0  | 110  | 120  | 160 |
|:--------------------:|:---:|:---: |:----:|:----:|:----:|
| 200                  | 8   | 9    | 10   | 9    |0
| 40                   | 5   | 3*140| 4    | 3    |0
| 130                  | 4   | 5    | 6    | 4    |0
| 170                  | 3   | 4    | 6    | 3    | 0

Мінімальний елемент  $c_{24} = 3$.

| $a_i \backslash b_j$ | 150 |   0  | 110  | 80  | 160 |
|:--------------------:|:---:|:---: |:----:|:----:|:----:|
| 200                  | 8   | 9    | 10   | 9    |0
| 0                    | 5   | 3*140| 4    | 3*40 |0
| 130                  | 4   | 5    | 6    | 4    |0
| 170                  | 3   | 4    | 6    | 3    | 0

Мінімальний елемент  $c_{41} = 3$.

| $a_i \backslash b_j$ | 0    |   0  | 110  | 80  | 160 |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 200                  | 8    | 9    | 10   | 9    |0
| 0                    | 5    | 3*140| 4    | 3*40 |0
| 130                  | 4    | 5    | 6    | 4    |0
| 20                   | 3*150| 4    | 6    | 3    | 0

Мінімальний елемент  $c_{44} = 3$.

| $a_i \backslash b_j$ | 0    |   0  | 110  | 60  | 160 |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 200                  | 8    | 9    | 10   | 9    |0
| 0                    | 5    | 3*140| 4    | 3*40 |0
| 130                  | 4    | 5    | 6    | 4    |0
| 0                    | 3*150| 4    | 6    | 3*20 | 0

Мінімальний елемент  $c_{34} = 4$.

| $a_i \backslash b_j$ | 0    |   0  | 110  | 0   | 160 |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 200                  | 8    | 9    | 10   | 9    |0
| 0                    | 5    | 3*140| 4    | 3*40 |0
| 70                   | 4    | 5    | 6    | 4*60 |0
| 0                    | 3*150| 4    | 6    | 3*20 | 0

Мінімальний елемент  $c_{33} = 6$.

| $a_i \backslash b_j$ | 0    |   0  | 40   | 0   | 160 |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 200                  | 8    | 9    | 10   | 9    |0
| 0                    | 5    | 3*140| 4    | 3*40 |0
| 0                    | 4    | 5    | 6*70 | 4*60 |0
| 0                    | 3*150| 4    | 6    | 3*20 | 0

Мінімальний елемент  $c_{13} = 10$.

| $a_i \backslash b_j$ | 0    |   0  | 0    | 0   | 160 |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 160                  | 8    | 9    | 10*40| 9    |0
| 0                    | 5    | 3*140| 4    | 3*40 |0
| 0                    | 4    | 5    | 6*70 | 4*60 |0
| 0                    | 3*150| 4    | 6    | 3*20 | 0

Мінімальний елемент  $c_{15} = 0$.

| $a_i \backslash b_j$ | 0    |   0  | 0    | 0   | 0 |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 0                    | 8    | 9    | 10*40| 9    |0*160
| 0                    | 5    | 3*140| 4    | 3*40 |0
| 0                    | 4    | 5    | 6*70 | 4*60 |0
| 0                    | 3*150| 4    | 6    | 3*20 | 0

В результаті отримано перший опорний план, який є допустимим, оскільки всі продукти вивезені від постачальників, потреби споживачів задоволенаі, а план відповідає системі обмежень транспортної задачі.

| $a_i \backslash b_j$ | 150 | 140 | 110 | 120 | 160 |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 200                  | 8    | 9    | 10*40| 9    |0*160
| 180                  | 5    | 3*140| 4    | 3*40 |0
| 130                  | 4    | 5    | 6*70 | 4*60 |0
| 170                  | 3*150| 4    | 6    | 3*20 | 0

Підрахуємо число зайнятих комірок таблиці, їх $8$, а має бути $m + n - 1 = 8$. Отже, опорний план є невиродженим.

Значення цільової функції для цього опорного плану:

$$F (x) = 10 * 40 + 0 * 160 + 3 * 140 + 3 * 40 + 6 * 70 + 4 * 60 + 3 * 150 + 3 * 20 = 2110$$

Перевіримо оптимальність опорного плану. Знайдемо попередні потенціали $u_i , v_j$ по зайнятим коміркам таблиці, в яких $u_i + v_j= c_{ij}$ , припускаючи, що $u_1 = 0$.

$$u_1 + v_3 = 10; 0 + v_3 = 10; v_3 = 10$$

$$u_3 + v_3 = 6; 10 + u_3 = 6; u_3 = -4$$

$$u_3 + v_4 = 4; -4 + v_4 = 4; v_4 = 8$$

$$u_2 + v_4 = 3; 8 + u_2 = 3; u_2 = -5$$

$$u_2 + v_2 = 3; -5 + v_2 = 3; v_2 = 8$$

$$u_4 + v_4 = 3; 8 + u_4 = 3; u_4 = -5$$

$$u_4 + v_1 = 3; -5 + v_1 = 3; v_1 = 8$$

$$u_1 + v_5 = 0; 0 + v_5 = 0; v_5 = 0$$

| $u_i \backslash v_j$ |  8   |  8   |  10  |  8   | 0    |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 0                    | 8    | 9    | 10*40| 9    |0*160
| -5                   | 5    | 3*140| 4    | 3*40 |0
| -4                   | 4    | 5    | 6*70 | 4*60 |0
| -5                   | 3*150| 4    | 6    | 3*20 | 0

Опорний план не є оптимальним, тому що існують оцінки вільних комірок, для яких $u_i + v_j > c_{ij}$

$$(2; 3): -5 + 10> 4; \Delta_{23} = -5 + 10 - 4 = 1> 0$$

Вибираємо максимальну оцінку вільної коміркам (2; 3): 4
Для цього в перспективну комірку (2; 3) поставимо знак «+», а в інших вершинах багатокутника чергуються знаки «- »,« + »,« - ».

| $a_i \backslash b_j$ | 150  | 140    | 110    | 120    | 160 |
|:--------------------:|:---: |:---:   |:----:  |:----:  |:----:|
| 200                  | 8    | 9      | 10*40  | 9      |0*160
| 180                  | 5    | 3*140  | 4 (+)  |3*40 (-)|0
| 130                  | 4    | 5      |6*70 (-)|4*60 (+)|0
| 170                  | 3*150| 4      | 6      | 3*20   | 0

З продуктів $x_{ij}$, що стоять в мінусових комірках, вибираємо найменше, тобто $у = min (2, 4) = 40$. Додаємо $40$ до обсягів продуктів, що стоять в плюсових коміпках і віднімаємо $40$ з $x_{ij}$ , що стоять в мінусових комірках. В результаті отримаємо новий опорний план.

| $a_i \backslash b_j$ | 150  | 140    | 110    | 120    | 160 |
|:--------------------:|:---: |:---:   |:----:  |:----:  |:----:|
| 200                  | 8    | 9      | 10*40  | 9      |0*160
| 180                  | 5    | 3*140  | 4*40   |3       |0
| 130                  | 4    | 5      |6*30    |4*100   |0
| 170                  | 3*150| 4      | 6      | 3*20   | 0

Перевіримо оптимальність опорного плану. Знайдемо попередні потенціали $u_i , v_j$ по зайнятим коміркам таблиці, в яких $u_i + v_j = c ij$ , вважаючи, що $u_1 = 0$.

$$u_1 + v_3 = 10; 0 + v_3 = 10; v_3 = 10$$

$$u_2 + v_3 = 4; 10 + u_2 = 4; u_2 = -6$$

$$u_2 + v_2 = 3; -6 + v_2 = 3; v_2 = 9$$

$$u_3 + v_3= 6; 10 + u_3 = 6; u_3 = -4$$

$$u_3 + v_4 = 4; -4 + v_4 = 4; v_4 = 8$$

$$u_4 + v_4 = 3; 8 + u_4 = 3; u_4 = -5$$

$$u_4 + v_1 = 3; -5 + v_1 = 3; v_1 = 8$$

$$u_1 + v_5 = 0; 0 + v_5 = 0; v_5 = 0$$


| $u_i \backslash v_j$ |  8   |  9   |  10  |  8   | 0    |
|:--------------------:|:---: |:---: |:----:|:----:|:----:|
| 0                    | 8    | 9    | 10*40| 9    |0*160
| -6                   | 5    | 3*140| 4*40 | 3    |0
| -4                   | 4    | 5    | 6*30 | 4*100|0
| -5                   | 3*150| 4    | 6    | 3*20 | 0

Опорний план є оптимальним, адже все оцінки вільних комірок задовольняють умові $u_i + v_j ≤ c_{ij}$.
Мінімальні витрати складуть: 

$$F (x) = 10 * 40 + 0 * 160 + 3 * 140 + 4 * 40 + 6 * 30 + 4 * 100 + 3 * 150 + 3 * 20 = 2070$$