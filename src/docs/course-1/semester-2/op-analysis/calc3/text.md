# М-задача

Для нижченаведених варіантів задач програмування виконати такі дії:
1. розв’язати М - задачу лінійного програмування;
2. розв’язати задачу лінійного програмування двоїстим симплекс-методом.

## Варіант 2.

$$5x_1 + 4x_2 + 6x_3 \to max $$

$$x_1 + x_2 + x_3 \leq 6 $$

$$2x_1+x_2+2x_3 \geq 9$$

$$3x_1 + x_2 + 2x_3 \geq 11$$

$$x_i \geq 0, i = 1,2,3$$

## Розв'язок

Запишемо задачу в канонічному вигляді:

$$5x_1 + 4x_2 + 6x_3 \to max $$

$$x_1 + x_2 + x_3 + x_4 = 6 $$

$$2x_1 + x_2 + 2x_3 - x_5 = 9$$

$$3x_1 + x_2 + 2x_3 - x_6 = 11$$

Введемо штучні змінні x : в другу рівність вводимо змінну $x_7$; в третю рівність вводимо змінну $x_8$:

$$5x_1 + 4x_2 + 6x_3 \to max $$

$$x_1 + x_2 + x_3 + x_4 = 6 $$

$$2x_1 + x_2 + 2x_3 - x_5 + x_7 = 9$$

$$3x_1 + x_2 + 2x_3 - x_6 + x_8 = 11$$

Додамо ці змінні у цільову функцію з коефіціентом $M$, який дорівнює дуже великому позитивному числу. Штучні змінні не мають відношення до змісту поставленого завдання, однак вони дозволять побудувати стартову точку, а процес оптимізації змусить ці змінні прийняти нульові значення і забезпечити допустимість оптимального рішення.

$$5x_1 + 4x_2 + 6x_3 - Mx_7 - Mx_8 \to max $$

Вирішимо систему рівнянь щодо базисних змінних (які входять тільки в одне рівняння системи обмежень і притому з одиничним коефіцієнтом): $x_4 , x_7 , x_8$

Вважаючи, що вільні змінні рівні 0, отримаємо перший опорний план:

$$ X_0 = (0,0,0,6,0,0,9,11) $$

$$
\begin{array}{|c| c |  c  ||  c  | c   | c   | c   | c   | c   | c   | c   ||  c|} 
\hline      &       &    & 5    & 4   &  6  & 0   & 0   & 0   & -M  &  -M &      \\ 
\hline Basis&C_{bas}&Plan& x_1  & x_2 & x_3 & x_4 & x_5 & x_6 & x_7 & x_8 &\theta\\ 
\hline
\hline   x_4&  0    & 6  & 1    & 1   &  1  & 1   & 0   & 0   & 0   &  0  &  6   \\ 
\hline   x_7&  -M   & 9  & 2    & 1   & 2   & 0   & -1  & 0   & 1   &  0  &  9/2 \\ 
\hline   x_8&  -M   &11  & (3)  & 1   & 2   & 0   & 0   & -1  & 0   &  1  &  11/3\\ 
\hline
\hline      &       &  0 &-5    &-4   &-6   & 0   & 0   & 0   & 0   &  0  &      \\ 
\hline      &       &-20M& -5M  &  -2M&  -4M& 0   & M   & M   & 0   &  0  &      \\ 
\hline\end{array}
$$

Поточний опорний план неоптимальний, тому що в індексному рядку знаходяться негативні коефіцієнти. В якості ведучого виберемо стовпець, відповідний змінній $x_1$, адже це найбільший коефіцієнт за модулем. Обчислимо значення $\theta$ по рядках, запишемо значення у останній стовпець і обремо найменше значення. Отже 3й рядок є ведучим. Позначимо розвґязальний елемент у таблиці дужками. Введемо до базису змінну $x_1$ і виведомо з базису змінну $x_8$, а потім перерахуємо таблицю:

$$
\begin{array}{|c| c |  c  ||  c  | c   | c   | c   | c   | c   | c   | c   ||  c|} 
\hline      &       &     & 5    & 4   &  6  & 0   & 0   & 0   & -M  &  -M &      \\ 
\hline Basis&C_{bas}& Plan& x_1  & x_2 & x_3 & x_4 & x_5 & x_6 & x_7 & x_8 &\theta\\ 
\hline
\hline   x_4&  0    &  7/3& 0    & 2/3 & 1/3 & 1   & 0   & 1/3 & 0   & -1/3&  7   \\ 
\hline   x_7&  -M   &  5/3& 0    & 1/3 &(2/3)& 0   & -1  & 2/3 & 1   & -2/3& 5/2  \\ 
\hline   x_1&  5    & 11/3& 1    & 1/3 & 2/3 & 0   & 0   & -1/3& 0   &  1/3& 11/2 \\ 
\hline
\hline      &       & 55/3& 0    &-7/3 &-8/3 & 0   & 0   &-5/3 & 0   & 5/3 &      \\ 
\hline      &       &-5/3M& 0    &-1/3M&-2/3M& 0   & M   &-2/3M& 0   & 5/3M&      \\ 
\hline\end{array}
$$

Поточний опорний план неоптимальний. Введемо до базису змінну $x_3$ і виведомо з базису змінну $x_7$, а потім перерахуємо таблицю:

$$
\begin{array}{|c| c |  c  ||  c  | c   | c   | c   | c   | c   | c   | c   ||  c|} 
\hline      &       &     & 5    & 4   &  6  & 0   & 0   & 0   & -M  &  -M &      \\ 
\hline Basis&C_{bas}& Plan& x_1  & x_2 & x_3 & x_4 & x_5 & x_6 & x_7 & x_8 &\theta\\ 
\hline
\hline   x_4&  0    &  3/2& 0    & 1/2 &  0  & 1   & 1/2 & 0   &-1/2 & 0   &  3   \\ 
\hline   x_3&  6    &  5/2& 0    & 1/2 &  1  & 0   & -3/2& 1   & 3/2 & -1  &      \\ 
\hline   x_1&  5    & 2   & 1    &  0  &  0  & 0   & (1) & -1  & -1  &  1  &  2   \\ 
\hline
\hline      &       & 25  & 0    &-1   &  0  & 0   & -4  &  1  & 4   & -1  &      \\ 
\hline      &       &  0  & 0    & 0   &  0  & 0   & 0   &  0  & M   & M   &      \\ 
\hline\end{array}
$$

Поточний опорний план неоптимальний. Введемо до базису змінну $x_5$ і виведомо з базису змінну $x_1$, а потім перерахуємо таблицю:

$$
\begin{array}{|c| c |  c  ||  c  | c   | c   | c   | c   | c   | c   | c   ||  c|} 
\hline      &       &     & 5    & 4   &  6  & 0   & 0   & 0   & -M  &  -M &      \\ 
\hline Basis&C_{bas}& Plan& x_1  & x_2 & x_3 & x_4 & x_5 & x_6 & x_7 & x_8 &\theta\\ 
\hline
\hline   x_4&  0    &  1/2& -1/2 & 1/2 &  0  & 1   &  0  &(1/2)&  0  & -1/2&   1  \\ 
\hline   x_3&  6    & 11/2&  3/2 & 1/2 &  1  & 0   &  0  &-1/2 &  0  & 1/2 &      \\ 
\hline   x_5&  0    & 2   & 1    &  0  &  0  & 0   &  1  & -1  & -1  &  1  &      \\ 
\hline
\hline      &       & 33  & 4    &-1   &  0  & 0   & 0   &  -3 &  0  & 3   &      \\ 
\hline      &       &  0  & 0    & 0   &  0  & 0   & 0   &  0  & M   & M   &      \\ 
\hline\end{array}
$$

Поточний опорний план неоптимальний. Введемо до базису змінну $x_6$ і виведомо з базису змінну $x_4$, а потім перерахуємо таблицю:


$$
\begin{array}{|c| c |  c  ||  c  | c   | c   | c   | c   | c   | c   | c   ||  c|} 
\hline      &       &     & 5    & 4   &  6  & 0   & 0   & 0   & -M  &  -M &      \\ 
\hline Basis&C_{bas}& Plan& x_1  & x_2 & x_3 & x_4 & x_5 & x_6 & x_7 & x_8 &\theta\\ 
\hline
\hline   x_6&  0    &  1  & -1   &  1  &  0  & 2   &  0  &  0  &  0  & -1  &      \\ 
\hline   x_3&  6    &  6  &  1   &  1  &  1  & 1   &  0  &  0  &  0  &  0  &      \\ 
\hline   x_5&  0    &  3  &  0   &  1  &  0  & 2   &  1  &  0  & -1  &  0  &      \\ 
\hline
\hline      &       & 36  & 1    & 2   &  0  & 6   & 0   &  0  & 0   & 0   &      \\ 
\hline      &       &  0  & 0    & 0   &  0  & 0   & 0   &  0  & M   & M   &      \\ 
\hline\end{array}
$$

Серед значень індексного рядка немає негативних. Тому ця таблиця визначає оптимальний план завдання. Зважаючи на те, що в оптимальному рішенні відсутні штучні змінні (вони дорівнюють нулю), дане рішення є допустимим.

Отже оптимальний план можна записати так:

$$x_1 = 0, x_2 = 0, x_3 = 6$$

$$F (X) = 5 * 0 + 4 * 0 + 6 * 6 = 36$$